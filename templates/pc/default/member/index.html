{template "header.html", "/"}
<div class="user_pic" style="margin: 10px;">
	<img src=""/>
</div>

<!--<div class="modal fade" id="avatar-modal" aria-hidden="true" aria-labelledby="avatar-modal-label" role="dialog" tabindex="-1">-->
	<!--<div class="ch-img-modal">-->
		<!--<div class="modal-content">-->
			<!--<form class="avatar-form">-->
				<!--<div class="ch-img-modal-header">-->
					<!--<button class="close" data-dismiss="modal" type="button">&times;</button>-->
					<!--<p class="ch-img-title" id="avatar-modal-label">修改头像</p>-->
				<!--</div>-->
				<!--<div class="modal-body">-->
					<!--<div class="avatar-body">-->
						<!--<div class="avatar-upload">-->
							<!--<label for="avatarInput" style="line-height: 35px;">图片上传</label>-->
							<!--<button class="btn"  type="button" style="height: 35px;" onclick="$('input[id=avatarInput]').click();" >请选择图片</button>-->
							<!--<input class="avatar-input hide" id="avatarInput" name="avatar_file" type="file" name="...">-->
						<!--</div>-->
						<!--<div class="avatar-wrapper" id="mytx"></div>-->
						<!--<div class="avatar-preview preview-md" ></div>-->
						<!--<div class="hr"></div>-->
						<!--<div class="avatar-btns">-->
							<!--<button class="btn avatar-save fa fa-save" type="button" data-dismiss="modal" onclick="dr_save()">保存修改</button>-->
							<!--<button type="button" class="btn fa fa-refresh" data-method="reset">-->
								<!--重置图片<span class="docs-tooltip" data-toggle="tooltip" title="" data-original-title="$().cropper(&quot;reset&quot;)" aria-describedby="tooltip866214"></span>-->
							<!--</button>-->
						<!--</div>-->
					<!--</div>-->
				<!--</div>-->
			<!--</form>-->
		<!--</div>-->
	<!--</div>-->
<!--</div>-->
<!--<script type="text/javascript">-->
    <!--function dr_save() {-->
        <!--dr_tips('正在上传...', 3, 2);-->
        <!--var tx = $('#mytx img').attr('src');-->
        <!--$.post("{dr_member_url('account/upload', array('iajax' => 1))}", {tx: tx}, function(data) {-->
            <!--if(data == 1) {-->
                <!--dr_tips('上传成功', 3, 1);-->
                <!--window.location.reload();-->
            <!--} else {-->
                <!--dr_tips('上传失败：'+data.code);-->
            <!--}-->
        <!--}, 'json');-->
    <!--}-->
<!--</script>-->
<script src="{THEME_PATH}liuwei/js/html2canvas.min.js" type="text/javascript" charset="utf-8"></script>

<!--内容开始-->
<div class="content">
	<section class="banner-image">
		<div class="banner-image">
			<img class="img-responsive" src="{THEME_PATH}liuwei/images/partner.png" alt="">
		</div>
		<div class="banner-mask">
			<p>个人中心</p>
			<p>Personal Center</p>
		</div>
	</section>
	<section class="subhead">
		<span>个人信息</span>
	</section>

	<article class="per-info">
		<section class="info-name">
			<div class="info-img">
				<img class="img-circle" data-toggle="modal" data-target="#avatar-modal" src="{$member.avatar_url}" alt="">
			</div>
			<p>{$member.username}</p>
		</section>

		<section class="info-det">
			<div class="modal fade ch-na"tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
				<div class="ch-na-modal">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<p>修改用户名</p>
					<form action="" class="ch-na-form form-group" method="post">
						<input name="uid" type="hidden" value="{$uid}" id="uid"/>
						<label for="pre-ch-na">请输入新用户名:</label>
						<span class="form-checked form-checked-t"></span>
						<input type="text" id="pre-ch-na" class="form-control" placeholder="用户名">
						<button class="btn btn-block" onclick="ch_username()" id="pre-ch-na-btn">确认修改</button>
					</form>
					<!--<script>-->
						<!--function ch_username() {-->
                            <!--$.ajax({-->
                                <!--type: "POST", dataType: "json", url: "{dr_member_url('account/newusername')}", data: post,-->
                                <!--success: function (data) {-->

                                <!--} ,-->
                                <!--error: function(HttpRequest, ajaxOptions, thrownError) {-->
                                    <!--alert(HttpRequest.responseText);-->
                                <!--}-->
                            <!--});-->
                        <!--}-->
					<!--</script>-->

				</div>
			</div>
			<div class="info-det-bl">
				<div class="det-title">
					<p>用户名</p>
				</div>
				<div class="det-body">
					<p>{$member.username}</p>
				</div>
				<!--<div class="det-btn pull-right">-->
					<!--<button class="btn" data-toggle="modal" data-target=".ch-na">修改</button>-->
				<!--</div>-->
			</div>

			<div class="info-det-bl">
				<div class="det-title">
					<p>邮箱</p>
				</div>
				<div class="det-body">
					<p>{$member.email}</p>
				</div>
				<div class="det-btn">

				</div>
			</div>
			<div class="modal fade ch-pd" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
				<div class="ch-pd-modal">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<p>修改密码</p>
					<form action="" class="ch-na-form form-group" method="post">
						<label class="control-label"><span>旧密码: </span>（请先验证旧密码）</label>
						<input type="password" class="form-control" id="oldPwd" name="password">
						<label class="control-label"><span>新密码: </span>（最小长度为6个字符）</label>
						<input type="password" class="form-control" id="newPwd" name="password1">
						<label class="control-label"><span>确认密码: </span>（最小长度为6个字符）</label>
						<input type="password" class="form-control" id="checkPwd" name="password2">
						<button class="btn btn-block" type="button" onclick="validOldPwd()">确认修改</button>
					</form>
				</div>
			</div>
			<div class="info-det-bl">
				<div class="det-title">
					<p>登录密码</p>
				</div>
				<div class="det-body">
					<p>密码长度要求至少6位，建议您经常修改密码，以保证帐号更加安全。</p>
				</div>
				<div class="det-btn pull-right">
					<button class="btn" data-toggle="modal" data-target=".ch-pd">修改</button>
				</div>
			</div>
		</section>
	</article>
</div>
<!--内容结束-->

<script type="text/javascript">
    function validOldPwd() {
        $.post("{dr_member_url('account/cpassword')}",{password: $("#oldPwd").val()},function(data){
            console.log(data)
			if (data) {
                dr_tips('旧密码不正确', 3, 1);
			} else {
//                dr_tips('修改成功', 3, 1);
                $.post("{dr_member_url('account/password')}",{password: $("#oldPwd").val(),password1: $("#newPwd").val(),password2: $("#checkPwd").val()},function(data){
                    if (data) {
                        dr_tips('修改成功', 3, 1);
                        setTimeout('window.location.href = "{dr_member_url('home/index')}"', 2000);
                    } else {
                        dr_tips('修改失败，请重新输入修改', 3, 1);
                    }
                });
			}
        });
    }
    $(document).ready(function () {
        var asd = true;
        if (asd ) {
            $('#pre-ch-na-btn').removeAttr('disabled');
            $('#pre-ch-na').removeClass('form-error');
            $('.form-checked').removeClass('form-checked-f');
            $('.form-checked').addClass('form-checked-t');
            $('.form-checked').text('用户名可用')
        }
        else {
            $('#pre-ch-na-btn').attr('disabled', true);
            $('#pre-ch-na').addClass('form-error');
            $('.form-checked').removeClass('form-checked-t');
            $('.form-checked').addClass('form-checked-f');
            $('.form-checked').text('用户名已存在！')
        }
    })
</script>

{template "footer.html", "/"}